<Defs>

    <ThingDef ParentName="CaveExit">
        <defName>CavernExit</defName>
        <label>cavern exit</label>
    </ThingDef>

    <ThingDef ParentName="BuildingBase" Name="CavernEntranceBase" Abstract="True">
    <defName>CavernEntranceBase</defName>
    <label>cavern entrance</label>
    <description>A massive, foreboding hole that connects the surface with a network of underground caves. It is possible to climb down into the cavern below. The entrance looks unstable and will collapse in a matter of days.</description>
    <size>(6,6)</size>
    <useHitPoints>false</useHitPoints>
    <thingClass>MiningOverhaul.CavernEntrance</thingClass>
    <tickerType>Normal</tickerType>
    <rotatable>false</rotatable>
    <terrainAffordanceNeeded>Heavy</terrainAffordanceNeeded>
    <canOverlapZones>false</canOverlapZones>
    <graphicData>
        <graphicClass>Graphic_Single</graphicClass>
        <texPath>Things/Building/PitGate/PitGate</texPath>
        <drawSize>(8,8)</drawSize>
    </graphicData>
    <altitudeLayer>FloorEmplacement</altitudeLayer>
    <passability>Impassable</passability>
    <holdsRoof>true</holdsRoof>
    <destroyable>false</destroyable>
    <building>
        <isEdifice>true</isEdifice>
        <deconstructible>false</deconstructible>
        <isTargetable>false</isTargetable>
        <isInert>true</isInert>
        <claimable>false</claimable>
        <expandHomeArea>false</expandHomeArea>
    </building>
    <portal>
        <traverseSound>TraversePitGate</traverseSound>
    </portal>
    <statBases>
        <Flammability>0</Flammability>
    </statBases>
    <inspectorTabs>
        <li>ITab_ContentsMapPortal</li>
    </inspectorTabs>
    <comps>
        <li Class="CompProperties_LeaveFilthOnDestroyed">
        <filthDef>Filth_LooseGround</filthDef>
        <thickness>5</thickness>
        </li>
    </comps>
    </ThingDef>


    <ThingDef ParentName="CavernEntranceBase">
        <defName>CavernEntranceVegetation</defName>
        <label>vegetation choked cavern entrance</label>
        <description>TODO</description>
        <portal>
            <pocketMapGenerator>CavernVegetationMapGenDef</pocketMapGenerator>
            <exitDef>CavernExit</exitDef>
        </portal>
        <inspectorTabs>
            <li>ITab_ContentsMapPortal</li>
        </inspectorTabs>
        <comps>
        <li Class="MiningOverhaul.CompProperties_CavernCreatureSpawner">
            <avoidanceRadius>15</avoidanceRadius>
            <spawnConfigs>
                <!-- Cave Evolution - All creature stages in one config -->
                <li>
                    <label>Cave Evolution</label>
                    <threatTiers>
                        <!-- Early Stage: Scavengers - Always present -->
                        <li>
                            <minInstability>0.0</minInstability>
                            <maxInstability>0.75</maxInstability>
                            <creaturesSpawned>1~3</creaturesSpawned>  <!-- Simple range: 1 to 3 creatures -->
                            <spawnIntervalHours>2</spawnIntervalHours>
                            <spawnChance>0.3</spawnChance>
                            <creatures>
                                <li><creatureDef>Rat</creatureDef><weight>3</weight><manhunterChance>0.05</manhunterChance></li>
                                <li><creatureDef>Squirrel</creatureDef><weight>2</weight><manhunterChance>0.05</manhunterChance></li>
                            </creatures>
                        </li>
                        
                        <!-- Mid Stage: Opportunists -->
                        <li>
                            <minInstability>0.25</minInstability>
                            <maxInstability>0.5</maxInstability>
                            <creaturesSpawned>1~2</creaturesSpawned>
                            <spawnIntervalHours>3</spawnIntervalHours>
                            <spawnChance>0.5</spawnChance>
                            <creatures>
                                <li><creatureDef>Spelopede</creatureDef><weight>2</weight><manhunterChance>0.2</manhunterChance></li>
                                <li><creatureDef>Megascarab</creatureDef><weight>3</weight><manhunterChance>0.3</manhunterChance></li>
                                <li><creatureDef>Bear_Grizzly</creatureDef><weight>2</weight><manhunterChance>0.2</manhunterChance></li>
                            </creatures>
                        </li>
                        
                        <!-- Late Stage: Apex Predators -->
                        <li>
                            <minInstability>0.5</minInstability>
                            <maxInstability>0.75</maxInstability>
                            <creaturesSpawned>2~4</creaturesSpawned>
                            <spawnIntervalHours>2.5</spawnIntervalHours>
                            <spawnChance>0.7</spawnChance>
                            <creatures>
                                <li><creatureDef>Spelopede</creatureDef><weight>3</weight><manhunterChance>0.7</manhunterChance></li>
                                <li><creatureDef>Megascarab</creatureDef><weight>3</weight><manhunterChance>0.7</manhunterChance></li>
                                <li><creatureDef>Bear_Grizzly</creatureDef><weight>2</weight><manhunterChance>0.5</manhunterChance></li>
                                <li><creatureDef>Megaspider</creatureDef><weight>1</weight><manhunterChance>0.9</manhunterChance></li>
                            </creatures>
                        </li>
                        
                        <!-- Final Stage: Ancient Horrors -->
                        <li>
                            <minInstability>0.75</minInstability>
                            <maxInstability>1.0</maxInstability>
                            <creaturesSpawned>3~6</creaturesSpawned>
                            <spawnIntervalHours>1.5</spawnIntervalHours>
                            <spawnChance>0.8</spawnChance>
                            <creatures>
                                <li><creatureDef>Megaspider</creatureDef><weight>3</weight><manhunterChance>0.9</manhunterChance></li>
                                <li><creatureDef>Spelopede</creatureDef><weight>2</weight><manhunterChance>0.8</manhunterChance></li>
                                <li><creatureDef>Megascarab</creatureDef><weight>2</weight><manhunterChance>0.7</manhunterChance></li>
                            </creatures>
                        </li>
                    </threatTiers>
                </li>
            </spawnConfigs>
        </li>
        </comps>
    </ThingDef>
</Defs>